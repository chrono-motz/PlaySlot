{
    "dataset": {
        "dataset_name": "BlockPush",
        "shuffle_train": true,
        "shuffle_eval": false,
        "datapath": "./datasets/BlockPush/BlockPush",
        "ep_len": 25,
        "num_frames": 8,
        "img_size": [64, 64],
        "random_start": false
    },
    "model": {
        "model_name": "SAVi",
        "model_params": {
            "num_slots": 8,
            "slot_dim": 128,
            "num_iterations_first": 3,
            "num_iterations": 1,
            "in_channels": 3,
            "mlp_hidden": 256,
            "mlp_encoder_dim": 128,
            "initializer": "Learned",
            "transition_module_params": {
                "model_name": "TransformerBlock",
                "num_heads": 4,
                "head_dim": 32,
                "mlp_size": 512
            },
            "encoder": {
                "encoder_name": "ConvEncoder",
                "encoder_params": {
                    "num_channels": [
                        32,
                        32,
                        32,
                        32
                    ],
                    "kernel_size": 5,
                    "resolution": [
                        64,
                        64
                    ],
                    "downsample_encoder": false,
                    "downsample": 2
                }
            },
            "decoder": {
                "decoder_name": "ConvDecoder",
                "decoder_params": {
                    "num_channels": [
                        64,
                        64,
                        64,
                        64
                    ],
                    "kernel_size": 5,
                    "resolution": [
                        64,
                        64
                    ],
                    "downsample_decoder": false,
                    "upsample": 1
                }
            }
        }
    },
    "predictor": {
        "predictor_name": "SlotSingleAction",
        "predictor_params": {
            "num_actions": 8,
            "action_dim": 16,
            "slot_dim": 128,
            "condition_mode": "sum",
            "use_variability": true,
            "autoregressive_dynamics": true,
            "LatentAction": {
                "model_name": "VQSingleSlotLatentAction",
                "model_params": {
                    "emb_dim": 256,
                    "num_layers": 4,
                    "num_heads": 4,
                    "head_dim": 64,
                    "mlp_dim": 1024,
                    "use_ema_vq": true
                }
            },
            "DynamicsModel": {
                "model_name": "SlotGPTDymamicsModel",
                "model_params": {
                    "residual": false,
                    "embed_dim": 256,
                    "head_dim": 64,
                    "num_heads": 8,
                    "mlp_size": 1024,
                    "num_layers": 4,
                    "pos_enc_dropout": 0
                }
            }
        }
    },
    "predictor_loss": [
        {
            "type": "pred_img_mse",
            "weight": 1
        },
        {
            "type": "pred_slot_mse",
            "weight": 1
        },
        {
            "type": "VQLoss",
            "weight": 1,
            "beta": 0.25
        }
    ],
    "training": {
        "num_epochs": 1500,
        "save_frequency": 10,
        "log_frequency": 100,
        "image_log_frequency": 100,
        "batch_size": 32,
        "train_iters_per_epoch": 1000,
        "valid_iters_per_epoch": 1000,
        "lr": 0.0001,
        "scheduler": "cosine_annealing",
        "scheduler_steps": 300000,
        "lr_warmup": true,
        "warmup_steps": 2000,
        "gradient_clipping": true,
        "clipping_max_value": 0.05
    },
    "prediction_params": {
        "num_context": 6,
        "num_preds": 8,
        "teacher_force": false,
        "sample_length": 14
    },
    "_general": {}
}